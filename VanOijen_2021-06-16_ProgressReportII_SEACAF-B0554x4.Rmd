---
title: 'Modelling Coffee Agroforestry in Central America with CAF2021'
subtitle: 'Progress report II for project SEACAF, sub-contract B0554x4'
author:
- Marcel van Oijen^[Independent researcher, Edinburgh, UK - VanOijenMarcel@gmail.com]
date: '`r Sys.Date()`'
output:
  pdf_document:
    fig_crop: false
    fig_caption: yes
    keep_tex: no
    number_sections: yes
    toc: yes
  word_document:
    reference_docx: word-styles-reference-01.docx
  html_document: default
fontsize: 11pt
geometry: margin=1in
csl: environmental-modelling-and-software.csl
bibliography: [Avocado.bib,Banana.bib,Experiments.bib,MvO.bib,SEACAF.bib]
---

```{r, include=FALSE}
  knitr::opts_chunk$set(echo=F,results="asis",warning=FALSE,message=FALSE)
```



\clearpage

# Introduction

This is the second progress report for project SEACAF on the process-based modelling of coffee agroforestry systems in Central America by means of the model CAF2021. The  first progress report [dated 30 April 2021; @VanOijen_2021_Modelling] provided details and references on the model that we do not repeat here. However, we have since made changes to model structure which we describe in the next section. After that we present details on a Bayesian calibration of the model using data from long-term experiments in Turrialba (Costa Rica) and Masatepe (Nicaragua). We conclude the report with a general discussion and an outlook to future work.


# CAF2021: further changes in model structure

User-friendliness. Several of the figures in this report. No further detail, but will be part of the user documentation to be provided in the final stage of project SEACAF.

Structural changes now to be discussed.

## Option to remove pruned leaves and branches from the field



## Tree height and light interception

- Stratification no longer assumed but developing over time.

# Bayesian calibration on data from Turrialba and Masatepe

- Differences between the two sites.
- Soils had different land-use histories. Only in Turrialba, the coffee agroforestry experiment represented land-use change (from sugar cane), and involved soil disturbance increasing soil aeration. Soil texture and composition also differed between the sites. The volcanic soils in Masatepe have more organic matter than the soils in Turrialba [@Noponen_2012_Carbon], but with lower decomposition rates. The combined effect was that soil loss over the course of the experiment was found to be much lower in Masatepe than in Turrialba [@Noponen_2013_Sink].
- The experiment used different shade tree species.
  - A deciduous tree species present in Masatepe. No need for model change: leaf senescence was already made to be accelerated by drought, which is consistent with the dry-season falling of leaves in S.s. (?).
  
```{r}
  Turrialba_trees <- c( rep("E" ,4), rep("T" ,4), rep("C" ,2),
                        rep("TE",2), rep("CE",4), rep("-" ,2) )
  fert4 <- c("CI","CM","OI","OM") ; fert2a <- c("CI","CM") ; fert2b <- c("CM","OI")
  Turrialba_fert  <- c( rep(fert4,2), rep(fert2b,2), fert4, fert2a )
                        
  Masatepe_trees <- c( rep("-"    ,2), rep("SSTR" ,2), rep("SGTR" ,4),
                       rep("ILSS" ,4), rep("ILSG" ,2), rep(NA,4)  )
  Masatepe_fert  <- c( fert2a, fert2b, rep(fert4,2), fert2b, rep(NA,4) )

  options(knitr.kable.NA = '')
  knitr::kable( cbind( 1:18, Turrialba_trees, Turrialba_fert,
                       rep(NA,18), 
                       c(19:32,rep(NA,4)), Masatepe_trees, Masatepe_fert ),
                col.names=c("TURRIALBA","Shade","Fertil.","","MASATEPE","Shade","Fertil."),
                caption="Long-term experiments in Turrialba (treatments 1:18)
                and Masatepe (treatments 19:32).
                  Shade trees: E = \\textit{Erythrina poeppigiana},
                    T = \\textit{Terminalia amazonia}, C = \\textit{Chloroleucon eurycyclum},
                    SS = \\textit{Samanea saman}, TR = \\textit{Tabebuia rosea},
                    SG = \\textit{Simarouba glauca}, IL = \\textit{Inga laurina}, .
                  Fertilisation regime: C = conventional, O = organic,
                                        I = intensive, M = moderate." )
```

```{r, include=FALSE}
  filesTM <- file.info(list.files(pattern="^BC_Turrialba_Masatepe.*\\.RData$"))
  # filesT  <- file.info(list.files(pattern="^BC_Turrialba......\\.RData$"))
  # filesM  <- file.info(list.files(pattern="^BC_Masatepe.*\\.RData$"))
  filesTM <- filesTM[ with(filesTM,order(as.POSIXct(mtime))), ]
  fileTM  <- tail( rownames(filesTM[1]), 1 )
```

## Parameter settings

- Compared to Masatepe, we set soil carbon time constants (TCLITT, TCSOMF, TCSOMS) for Turrialba at lower values and have a larger fraction of SOM in the fast pool (larger FCSOMF0).
- RNLEACH	is set at 0.5 for both sites. However, the fraction of N that leaches depends on soil type [@Harmand_2007_Nitrogena], so different settings for the two sites would be realistic.
  - Our notes give values of leaching in Turrialba of 16-27 kgN ha-1 y-1. Where do these numbers come from (which publication, which experimental treatments)?

## Calibration data and constraints

- Data files provided by Elias for Turrialba and by Jeremy for Masatepe
- Additionally, some data were taken from the following publications:
  - Noponen
  - Ovalle et al. 
  - Spanish text on Masatepe
  - Haggar et al. (2011)
- Future data use:
  - Rolando Cerda data files for the Turrialba region
  - Data on coffee agroforestry in LLano Bonito (Tarrazu)
  


- Csoil: we should expect the sites in Masatepe to be closer to equilibrium from the start than the Turrialba ones because of differences in preceding land-use. The experiment in Masatepe followed on earlier use for coffee production (so no land-use change) whereas the site in Turrialba was originally used for sugar cane. Also, the volcanic soils in Masatepe tend to be bind organic matter and minerals better than the soils at Turrialba. These differences in soil properties may explain why Noponen found greater Csoil-loss in Turrialba despite lower initial Csoil-stock there.
- Other biogeochemistry balances to include?
- Leaching of N: expected to be very small in case of lowest fertilisation.
- Consider recalculating the coffee yields in Nicaragua by dividing FWT by 3.87 (rather than the current value of 3), which would make all yields 22.5% lower.

- Aboveground tree biomass in 2016 (Mg C ha-1) for Masatepe was taken from Sepulveda et al. (2016), Table 12, and units were converted to kg C m-2.
  - NOT USEABLE: 2016 is beyond simulation period.

```{r}
  Sepulveda_treatments <- c(
    "ILSG_CM", "ILSG_OI",
    "SGTR_CI", "SGTR_CM", "SGTR_OI", "SGTR_OM",
    "SSIL_CI", "SSIL_CM", "SSIL_OI", "SSIL_OM",
    "SSTR_CM", "SSTR_OI")
  Sepulveda_CabgT_f       <- c(
     40.1    ,  32.6    ,
     61.1    ,  60.5    ,  56.4    ,  55.6    ,
     19.6    ,  21.7    ,  24.7    ,  19.9    ,
     51.1    ,  51.2    ) * 1e3 * 1e-4
  cbind( Sepulveda_treatments, Sepulveda_CabgT_f )
```

Carbon pools for Costa Rica in 2009 were taken from Noponen (2012, thesis Table A4.1) and converted from Mg C ha-1 to kg C m-2. 

```{r}
Noponen_treatments <- c(
  "C_CM" , "C_OI" ,
  "E_CI" , "E_CM" , "E_OI", "E_OM",
  "ET_CM", "ET_OI",
  "FS_CI", "FS_CM",
  "T_CI" , "T_CM" , "T_OI", "T_OM" )
Noponen_CabgT_f    <- round( c(
   87.57 ,  87.62 ,
    9.69 ,  18.79 ,  16.96,  16.64,
   41.82 ,  23.98 ,
    0    ,   0    ,
   81.82 ,  41.21 ,  38.65,  36.39 ) * 1e3 * 1e-4, 2 )
Noponen_Cabg_f     <- round( c(
    4.05 ,   4.35 ,
    5.16 ,   4.54 ,   5.55,   5.58,
    4.50 ,   3.82 ,
    4.98 ,   3.41 ,
    5.41 ,   4.19 ,   4.36,   1.51 ) * 1e3 * 1e-4, 2 )
cbind( Noponen_treatments, Noponen_CabgT_f, Noponen_Cabg_f )
```

Changes during the nine years 2001-2010 in  soil carbon pools for both countries were given by Noponen (2012, thesis Tables A5.2, A5.3). The values given in those tables were main effects for the shade and fertilisation treatments which we added to estimate carbon change in each of the experimental treatments. The Noponen data are in Mg C ha-1 for the top 40 cm of soil (which we assumed contained 75% of total soil carbon). We thus converted the data to kg C m-2 y-1 in the full soil column by multiplying with 1000 * (100/75) / 9.

The calculations were:

```{r}
        DSOC_CRI_shade  <- c(  -9.23, -13.86, -5.89, -12.54, -7.26 )
  names(DSOC_CRI_shade) <- c( "FS"  , "E"   , "ET" , "C"   , "T"   )
        DSOC_CRI_fert   <- c( -11.40, -10.94, -7.49, -10.44 )
  names(DSOC_CRI_fert)  <- c( "CI"  , "CM"  , "OI" , "OM"   )

        DSOC_NIC_shade  <- c( -2.97,  0    , -3.97 , -2.37,   14.20 )
  names(DSOC_NIC_shade) <- c( "FS" , "ILSG", "ILSS", "SGTR", "SSTR" )
        DSOC_NIC_fert   <- c( -6.08,  1.07 ,  2.12 ,  0.82 )
  names(DSOC_NIC_fert)  <- c( "CI" , "CM"  , "OI"  , "OM"  )
  
  n_CRI_shade <- c( 2, 4, 2, 2, 4 )
  n_CRI_fert  <- c( 3, 5, 4, 2 )
  n_NIC_shade <- c( 2, 2, 4, 4, 2 )
  n_NIC_fert  <- c( 3, 5, 4, 2  )
  
  mCRI <- 0.5 * (
    sum( DSOC_CRI_shade * n_CRI_shade ) / sum(n_CRI_shade) +
    sum( DSOC_CRI_fert  * n_CRI_fert  ) / sum(n_CRI_fert ) )
    
  mNIC <- 0.5 * (
    sum( DSOC_NIC_shade * n_NIC_shade ) / sum(n_NIC_shade) +
    sum( DSOC_NIC_fert  * n_NIC_fert  ) / sum(n_NIC_fert ) )
  
  aCRI_shade <- DSOC_CRI_shade - mCRI
  aCRI_fert  <- DSOC_CRI_fert  - mCRI
  aNIC_shade <- DSOC_NIC_shade - mNIC
  aNIC_fert  <- DSOC_NIC_fert  - mNIC
  
  treatments_CRI <- c(
    "Tu01_E_AC.R" , "Tu02_E_MC.R" , "Tu03_E_MO.R" , "Tu04_E_BO.R" ,
    "Tu05_T_AC.R" , "Tu06_T_MC.R" , "Tu07_T_MO.R" , "Tu08_T_BO.R" ,
    "Tu09_C_MC.R" , "Tu10_C_MO.R" ,
    "Tu13_TE_MC.R", "Tu14_TE_MO.R",
    "Tu19_PS_AC.R", "Tu20_PS_MC.R" )
  effects_CRI    <- mCRI + c(
    aCRI_shade["E" ] + aCRI_fert["CI"],
    aCRI_shade["E" ] + aCRI_fert["CM"],
    aCRI_shade["E" ] + aCRI_fert["OI"],
    aCRI_shade["E" ] + aCRI_fert["OM"],
    aCRI_shade["T" ] + aCRI_fert["CI"],
    aCRI_shade["T" ] + aCRI_fert["CM"],
    aCRI_shade["T" ] + aCRI_fert["OI"],
    aCRI_shade["T" ] + aCRI_fert["OM"],
    aCRI_shade["C" ] + aCRI_fert["CM"],
    aCRI_shade["C" ] + aCRI_fert["OI"],
    aCRI_shade["ET"] + aCRI_fert["CM"],
    aCRI_shade["ET"] + aCRI_fert["OI"],
    aCRI_shade["FS"] + aCRI_fert["CI"],
    aCRI_shade["FS"] + aCRI_fert["CM"] ) # kgC ha-1 in top 40 cm over 9 years 
  effects_CRI_kghay <- round( effects_CRI * 1e3 * (4/3) / 9, 0 ) # kgC ha-1 y-1
  cbind( treatments_CRI, effects_CRI_kghay )

  treatments_NIC <- c(
    "Ma01_PS_CI.txt"  , "Ma02_PS_CM.txt"  ,
    "Ma03_SSTR_CM.txt", "Ma04_SSTR_OI.txt",
    "Ma05_SGTR_CI.txt", "Ma06_SGTR_CM.txt", "Ma07_SGTR_OI.txt", "Ma08_SGTR_OM.txt",
    "Ma09_ILSS_CI.txt", "Ma10_ILSS_CM.txt", "Ma11_ILSS_OI.txt", "Ma12_ILSS_OM.txt",
    "Ma13_ILSG_CM.txt", "Ma14_ILSG_OI.txt" )
  effects_NIC    <- mNIC + c(
    aNIC_shade["FS"  ] + aNIC_fert["CI"],
    aNIC_shade["FS"  ] + aNIC_fert["CM"],
    aNIC_shade["SSTR"] + aNIC_fert["CM"],
    aNIC_shade["SSTR"] + aNIC_fert["OI"],
    aNIC_shade["SGTR"] + aNIC_fert["CI"],
    aNIC_shade["SGTR"] + aNIC_fert["CM"],
    aNIC_shade["SGTR"] + aNIC_fert["OI"],
    aNIC_shade["SGTR"] + aNIC_fert["OM"],
    aNIC_shade["ILSS"] + aNIC_fert["CI"],
    aNIC_shade["ILSS"] + aNIC_fert["CM"],
    aNIC_shade["ILSS"] + aNIC_fert["OI"],
    aNIC_shade["ILSS"] + aNIC_fert["OM"],
    aNIC_shade["ILSG"] + aNIC_fert["CM"],
    aNIC_shade["ILSG"] + aNIC_fert["OI"] )
  effects_NIC_kghay <- round( effects_NIC * 1e3 * (4/3) / 9, 0 ) # kgC ha-1 y-1
  cbind( treatments_NIC, effects_NIC_kghay )
```


## Results from BC

Unless otherwise indicated, all simulation results shown in this section are for the Maximum A Posteriori (MAP) paramater vector from a single multi-site calibration of CAF2021 on data from Turrialba and Masatepe.

Fig. \ref{fig:YieldsObsSimTurrialbaMasatepe} shows average observed coffee yield in the 32  treatments (18 from Turrialba, 14 from Masatepe) against N-fertilisation rate and against simulated yield.

```{r, out.width="100%", fig.cap="\\label{fig:YieldsObsSimTurrialbaMasatepe}Yields for the 32 treatments in Turrialba and Masatepe. Left: Observed yields against N-fertilisation level. Right: Observed yield vs. simulated yield."}
  load( fileTM )
  source(sitesettings_filenames[1]) # Knitting requires a model initialisation

  source('BC/BC_Yields.R')
  s.plot <- 1:nSites ; source('BC/BC_plot_YieldsAverage.R')
  # source('BC/BC_plot_YieldsAnnual.R')
```

Fig. \ref{fig:BalancesTurrialbaMasatepe} shows carbon and nitrogen balances in the 32 treatments (1:18 from Turrialba, 19:32 from Masatepe), for the whole simulated period of over 17 resp. 13 years. 

```{r, out.width="100%", fig.cap="\\label{fig:BalancesTurrialbaMasatepe}Carbon- and nitrogen-balances for 32 treatments. 1:18 = Turrialba, 19:32 = Masatepe. Simulations using the MAP parameter vector from Bayesian calibration."}
  load( fileTM )
  source(sitesettings_filenames[1]) # Knitting requires a model initialisation

  source('BC/BC_Balances.R')
  source('BC/BC_plot_Balances.R')
```

N-fixation and N-leaching in the final year. 

```{r}
  load( fileTM )
  source(sitesettings_filenames[1]) # Knitting requires a model initialisation

  # source('BC/BC_Final.R')
  # iNfixT     <- which(outputNames=="NfixT_f_hay")
  # iNleaching <- which(outputNames=="Nleaching_f_hay")

  source('BC/BC_FinalYearMean.R')
  iNfixT     <- which(outputNames=="NfixT_f")
  iNleaching <- which(outputNames=="Nleaching_f")

  par( mfrow=c(2,1), mar=c(3,2,2,0) )
  
  colbars <- c( "gray40"    , "gray80"    , "gray60"    , "gray100"   ,
                "gray40"    , "gray80"    , "gray60"    , "gray100"   ,
                "gray80"    , "gray60"    ,
                "gray80"    , "gray60"    ,
                "gray40"    , "gray80"    , "gray60"    , "gray100"   ,
                "gray40"    , "gray80"    ,
                "firebrick4", "firebrick2", 
                "firebrick2", "firebrick3",
                "firebrick4", "firebrick2", "firebrick3", "firebrick1", 
                "firebrick4", "firebrick2", "firebrick3", "firebrick1",
                "firebrick2", "firebrick3" )
  # barplot( as.matrix(outputFinalDay[,iNfixT]),
  barplot( as.matrix(outputFinalYearMean[,iNfixT]) * 1e4 * 365,
           main=paste( "Turrialba     ",
                       "N-FIXATION (kg N ha-1 y-1)",
                       "      Masatepe" ),
           col=colbars, beside=TRUE )
  # barplot( as.matrix(outputFinalDay[,iNleaching]),
  barplot( as.matrix(outputFinalYearMean[,iNleaching]) * 1e4 * 365,
           main="N-LEACHING (kg N ha-1 y-1)",
           col=colbars, beside=TRUE, names.arg=1:nSites )
```

```{r}
  load( fileTM )

  sA <- 1 ; sB <- 2 ; sC <- 3 ; sD <- 4
  source(sitesettings_filenames[sA]) ; params.MAP.A <- params.MAP.s( sA )
  output.MAP.A <- run_model( p=params.MAP.A )
  source(sitesettings_filenames[sB]) ; params.MAP.B <- params.MAP.s( sB )
  output.MAP.B <- run_model( p=params.MAP.B )
  source(sitesettings_filenames[sC]) ; params.MAP.C <- params.MAP.s( sC )
  output.MAP.C <- run_model( p=params.MAP.C )
  source(sitesettings_filenames[sD]) ; params.MAP.D <- params.MAP.s( sD )
  output.MAP.D <- run_model( p=params.MAP.D )
```

```{r}
  par( mfrow=c(2,4) )

  par(mar=c(3,3,3,0))
  plot_NbalanceSoil(output.MAP.A, title1="", title2="CI", ymax=800)
  par(mar=c(3,3,3,0))
  plot_NbalanceSoil(output.MAP.B, title1="", title2="CM", ymax=800)
  par(mar=c(3,3,3,0))
  plot_NbalanceSoil(output.MAP.C, title1="", title2="OI", ymax=800)
  par(mar=c(3,3,3,0))
  plot_NbalanceSoil(output.MAP.D, title1="", title2="OM", ymax=800)
```

## Sensitivity analyses

### N-leaching (parameter RNLEACH) 

We explore sensitivity of model outputs to the leaching-parameter 'RNLEACH'.

```{r, out.width="100%", fig.cap="\\label{fig:TurrialbaMasatepeYields2}Yields using the MAP parameter vector from Bayesian calibration, but with some additional parameter change(s)."}
  load( fileTM )
  source(sitesettings_filenames[1]) # Knitting requires a model initialisation

  set_parNames  <- c( "RNLEACH" )
  set_parValues <- c(  0.2      )
  source('BC/BC_Yields_set_par.R')
  source('BC/BC_plot_YieldsAverage.R')
```

```{r, out.width="100%", fig.cap="\\label{fig:TurrialbaMasatepeBalances2}Balances using the MAP parameter vector from Bayesian calibration, but with some additional parameter change(s)."}
  load( fileTM )
  source(sitesettings_filenames[1]) # Knitting requires a model initialisation

  source('BC/BC_Balances_set_par.R')
  source('BC/BC_plot_Balances.R')
```

### Deciduousness

```{r}
  load( fileTM )

  sA            <- 23 # Masatepe_05_SGTR_CI
  source(sitesettings_filenames[sA])
  params        <- params.MAP.s( sA )
  params.MAP.A  <- params
  params.MAP.A1 <- set_par( c("FTCLMINT(3)","TCLMAXT(3)"),
                            c( 0.2         , 650        ) )
  params.MAP.A2 <- set_par( c("FTCLMINT(3)","TCLMAXT(3)"),
                            c( 0.05        , 650        ) )
  params.MAP.A3 <- set_par( c("FTCLMINT(3)","TCLMAXT(3)"),
                            c( 0.2         , 365        ) )
  output.MAP.A  <- run_model( p=params.MAP.A  )
  output.MAP.A1 <- run_model( p=params.MAP.A1 )
  output.MAP.A2 <- run_model( p=params.MAP.A2 )
  output.MAP.A3 <- run_model( p=params.MAP.A3 )

  plot_output( list_output=list( output.MAP.A,
                                 output.MAP.A1, output.MAP.A2 ,output.MAP.A3),
               vars=c( "fTranT_t(3)", "LAIT_t(3)" ) )
```

### Impact of removing pruned leaves and branches

Comparison of leaving tree branches on the field after thinning and pruning (default) vs. removing them as harvest (customary in NIC and GTM): Fig. \ref{fig:Balances2}.

```{r Balances2, fig.height=6, fig.cap="\\label{fig:Balances2}Soil N- and C-balances at Masatepe in the ILSS_CI system. Top row: tree branches harvested and removed after pruning and thinning. Bottom row: branches left on the field as litter."}
  load( fileTM )
  sA <- 27 # Masatepe_09_ILSS_CI
  source(sitesettings_filenames[sA])
  params        <- params.MAP.s( sA )
  params.MAP.A  <- params
  params.MAP.A1 <- set_par( c("FHARVBT(1)","FHARVBT(2)","FHARVBT(3)"),
                            c( 0          , 0          , 0          ) )
  output.MAP.A  <- run_model( p=params.MAP.A  )
  output.MAP.A1 <- run_model( p=params.MAP.A1 )

  par( mar=c(3,3,3,0), mfrow=c(2,4) )
  plot_NbalanceSoil( output.MAP.A , title1="Soil N-balance MAP", title2="" )
  par( mar=c(3,3,3,0) )
  plot_CbalanceSoil( output.MAP.A , title1="Soil C-balance MAP", title2="" )
  par( mar=c(3,3,3,0) )
  plot_NbalanceSoil( output.MAP.A1, title1="Soil N-balance 1", title2="" )
  par( mar=c(3,3,3,0) )
  plot_CbalanceSoil( output.MAP.A1, title1="Soil C-balance 1", title2="" )
```

## Turrialba vs. Masatepe

```{r}
  load( fileTM )
  source(sitesettings_filenames[1]) # Knitting requires a model initialisation

  source('BC/BC_Yields.R')
  s.plot <-  1:18 ; source('BC/BC_plot_YieldsAverage.R')
  s.plot <- 19:32 ; source('BC/BC_plot_YieldsAverage.R')
```

### After a BC: comparing posterior with prior

```{r}
  load( fileTM )
  sTa             <- 13
  source(sitesettings_filenames[13]) # Turrialba_15_CE_AC
  params.Prior.Ta <- params
  params.MAP.Ta   <- params.MAP.s( sTa )
  output.Prior.Ta <- run_model( p=params.Prior.Ta )
  output.MAP.Ta   <- run_model( p=params.MAP.Ta )

  plot_output( list_output=list(output.Prior.Ta),
               vars       =c( "fTran(1)"    , "fNgrowth(1)", "DVS(1)"  ,
                              "SINKP(1)"    , "DayFl(1)"   , "PARMA(1)" ,
                              "harvDM_f_hay", "CT_f" ) )
  plot_output( list_output=list(output.MAP.Ta),
               vars       =c( "fTran(1)"    , "fNgrowth(1)", "DVS(1)"  ,
                              "SINKP(1)"    , "DayFl(1)"   , "PARMA(1)" ,
                              "harvDM_f_hay", "CT_f" ) )
```

# Discussion and outlook

## BC

- Basis for BC remains narrow, dominated by just two locations: Turrialba in Costa Rica and Masatepe in Nicaragua.

- N-leaching difficult to evaluate. No measurements were available for the calibration sites, and the few measurements carried out in Central America show that leaching varies both between sites (as a function of dfferences in soil type and management) and between depths in the soil where measurements are taken. For a coffee site in southern Costa Rica, @Harmand_2007_Nitrogena found N-leaching rates in kg N ha-1 y-1 to be 201-268 at 0.6 m depth, 70-113 at 1.2 m, and 16-27 at 2.0 m, with the highest values for the unshaded plot and the lowest for one shaded by *Eucalyptus deglupta*.

## BC Banana (avocado?, citrus?)
- Using data from Roland Cerda: banana.
  - From Rolando's file: choose farms with high fruit tree density and simulate them as extra treatments in the Turrialba experiment (for soil, weather etc.): EMu = poro + banana, ECi = poro + citrus.

## BC Llano Bonito (and perhaps Aquiares)

- Files from Oriana. LB at 1600+ m, Aquiares at 1000+ m.
- At LB there were Musaceae, but not in the data files (two tree species could then not be handled by CAF2014), but check @Meylan_2017_Evaluating.
- Aquiares had unusual poro management: no thinning, no pruning.


<br>  
<br>  
<br>  
<br>  
<br>  
<br>  
<br>  
<br>  
  
  
## Then ...
- Use SEACAF farm database to prepare input files for CAF2021
- Simulate full time series from COSA1 to present day for all farms in Costa Rica and Guatemala
- Analyse shade management and fertilization impacts on yields and environment


# Acknowledgements {-}

I thank the Natural Resources Institute of the University of Greenwich for funding, and my colleagues in project SEACAF and earlier projects for support.



\clearpage

# References {-}
